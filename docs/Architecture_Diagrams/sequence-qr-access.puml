@startuml Sequence - QR Access
title Ref: UC-PUB-01 (Scan Room QR Code)

actor "Public User" as User
participant "Mobile Browser" as Browser
participant "Next.js Frontend\n(Vercel)" as FE
participant "FastAPI Backend\n(Tunnel)" as BE
database "MongoDB" as DB
participant "AI Engine\n(PyTorch)" as AI

== User Scan ==
User -> Browser: Scan QR Code
Browser -> FE: GET /scan/[device_id]
activate FE

FE -> BE: GET /api/sensors/[device_id]
activate BE
BE -> DB: FindOne('devices', id)
DB --> BE: Device Metadata
BE -> DB: FindLast('sensor_logs', id)
DB --> BE: Telemetry Data
BE --> FE: JSON {device, telemetry}
deactivate BE

== Prediction Fetch ==
FE -> FE: Render Current Status UI
FE -> BE: GET /predict (async)
activate BE
BE -> AI: Inference(history_data)
AI --> BE: Forecast list[6h]
BE --> FE: JSON {forecast}
deactivate BE

FE -> FE: Render Line Chart
FE --> User: Show Full Page
deactivate FE
@enduml