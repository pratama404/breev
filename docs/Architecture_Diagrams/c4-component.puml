@startuml Component Diagram - Backend API
!include https://raw.githubusercontent.com/plantuml-stdlib/C4-PlantUML/master/C4_Component.puml

title Component Diagram - FastAPI Backend Service

Container(api_app, "FastAPI Application", "Python", "Main Application Entrypoint")

Container_Boundary(controllers, "API Controllers") {
    Component(c_ingest, "Ingestion Controller", "inference_api.py", "Handles /ingest endpoint")
    Component(c_predict, "Prediction Controller", "inference_api.py", "Handles /predict endpoint")
    Component(c_analytics, "Analytics Controller", "inference_api.py", "Handles /analytics endpoint")
}

Container_Boundary(logic, "Business Logic Layer") {
    Component(l_auth, "Auth Handler", "Security", "Validates x-api-key")
    Component(l_ai, "AI Engine", "PyTorch/LSTM", "Computes Forecasts")
    Component(l_db, "Database Service", "Motor/PyMongo", "Async DB Operations")
}

Rel(api_app, c_ingest, "Routes")
Rel(api_app, c_predict, "Routes")
Rel(api_app, c_analytics, "Routes")

Rel(c_ingest, l_auth, "Validate Key")
Rel(c_ingest, l_db, "Store Log")

Rel(c_predict, l_ai, "Request Forecast")
Rel(l_ai, l_db, "Fetch History")

Rel(c_analytics, l_db, "Aggregate Data")

@enduml