@startuml C4 Container Diagram
!include https://raw.githubusercontent.com/plantuml-stdlib/C4-PlantUML/master/C4_Container.puml

title Container Diagram - AQI Monitoring System

Person(user, "Building Occupant", "Uses QR codes to access room data")
Person(admin, "Facility Manager", "Manages sensors and system")

System_Boundary(breev, "Breev Hybrid Architecture") {
    Container(web, "Web Dashboard", "Next.js (Vercel)", "Admin UI & Public QR Views")
    
    System_Boundary(local, "Local Server (Proxmox/Docker)") {
        Container(tunnel, "Cloudflare Tunnel", "cloudflared", "Exposes local services safely")
        Container(api, "Backend API", "Python FastAPI", "Handles Sensor Data & Logic")
        Container(ml_engine, "AI Engine", "PyTorch", "Calculates Forecasts")
    }
    
    ContainerDb(db, "Cloud Database", "MongoDB Atlas", "Stores Sensor Logs & Config")
}

System_Ext(mobile, "Mobile Device", "Smartphone with QR scanner")
System_Ext(dagshub, "DagsHub", "ML Experiment Tracking")

Rel(user, web, "Views Real-time Data", "HTTPS")
Rel(admin, web, "Configures System", "HTTPS")

Rel(web, tunnel, "Fetch Analytics", "HTTPS/JSON")
Rel(tunnel, api, "Forward Request", "TCP/8000")

Rel(api, db, "Read/Write Logs", "MongoWire")
Rel(api, ml_engine, "Request Forecast", "Internal Call")
Rel(ml_engine, db, "Read History", "MongoWire")

@enduml